<!DOCTYPE html>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <meta name="theme-color" content="rgb(46, 44, 79)">
  <meta name="description" content="Git åˆ†æ”¯åŸç†">
  <meta name="keywords" content="Git">
  <title>
    Git åŸç†åˆ†æ”¯
  </title>
  <link rel="stylesheet" href="/public/css/index.css">
  <link rel="stylesheet" href="/public/css/markdown.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" />
  <script src="/public/JavaScript/index.js"></script>
</head><header class="blog-header">
  <a href="https://github.com/fwqaaq" target="_blank">
    <img src="https://avatars.githubusercontent.com/u/82551626?v=4" loading="lazy" alt="me" srcset="">
  </a>
  <nav class="header-nav">
    <a class="decoration-line" href="/"><i class="fa-solid fa-house-chimney fa-xs"></i>
      <span class="disappear">Home</span>
    </a>
    <a class="decoration-line" href="/./about/index.html"><i class="fa-solid fa-address-card fa-xs"></i>
      <span class="disappear">About</span></a>
    <a class="decoration-line" href="/./archive/index.html"><i class="fa-solid fa-box-archive fa-xs"></i> <span
        class="disappear">Archive</span></a>
    <a class="decoration-line" href="/./tags/index.html"><i class="fa-solid fa-tag fa-xs"></i> <span
        class="disappear">Tag</span></a>
    <div class="toy"><i class="fa-solid fa-gamepad fa-xs"></i> <span class="disappear">Toy</span>
      <nav class="toy-nav disappear">
        <a class="decoration-line" href="/public/resume/">æˆ‘çš„ç®€å†</a>
        <a class="decoration-line" href="/public/write-css/index.html">å­¦ä¹  UI</a>
      </nav>
    </div>
    <a class="decoration-line" href="/feed.xml"><i class="fa-solid fa-rss fa-xs"></i> <span
        class="disappear">RSS</span></a>
    <a class="decoration-line model" href="#" class="model"><i class="fa-solid fa-sun fa-xs"></i></a>
  </nav>
</header><main class="blog-main">
          <article class="blog-article">
            <h1>Git åŸç†åˆ†æ”¯</h1>
            <hr>
            <h2 id="åˆ†æ”¯">åˆ†æ”¯<a class="anchor" aria-label="Anchor" aria-hidden="true" data-anchorjs-icon="ğŸ”—" href="#åˆ†æ”¯"></a></h2>
<div class="markdown-alert markdown-alert-note">
<p class="markdown-alert-title"><svg class="octicon octicon-info mr-2" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"></path></svg>Note</p>
<p>é€šè¿‡ <code>HEAD</code> æ–‡ä»¶å¯ä»¥çŸ¥é“å½“å‰åœ¨å“ªä¸ªåˆ†æ”¯å·¥ä½œï¼Œå¹¶ä¸” <strong>HEAD æŒ‡å‘çš„åˆ†æ”¯</strong>æ€»æ˜¯æŒ‡å‘æœ€æ–°çš„ <code>commit</code></p>
</div>
<pre><code class="hl language-bash">                            HEAD
                              |
                            master
                              |
                       â”œâ”€---a219fd
1e735a  &#x3C;--- 8532d9 &#x3C;--|     
                       â”œâ”€---e78125
                              |
                             dev
</code></pre>
<ul>
<li>é€šè¿‡åˆ‡æ¢ <code>HEAD</code> çš„æŒ‡å‘å¯ä»¥åˆ‡æ¢åˆ†æ”¯</li>
</ul>
<blockquote>
<p>äº§çœ‹å½“å‰åˆ†æ”¯å†…å®¹</p>
</blockquote>
<pre><code class="hl language-bash"><span class="hl-built_in">cat</span> .git/HEAD
<span class="hl-comment"># ref: refs/heads/master</span>
<span class="hl-built_in">cat</span> .git/refs/heads/master
<span class="hl-comment"># b27787b75a99a614f3b26fe482f0cd47bc3c186b (å½“å‰åˆ†æ”¯æŒ‡å‘æœ€æ–°çš„ commit)</span>
git cat-file -t b27787b
<span class="hl-comment"># commit</span>
</code></pre>
<blockquote>
<p>åˆ›å»ºåˆ†æ”¯</p>
</blockquote>
<ul>
<li><code>git branch dev</code>:åˆ›å»ºä¸€ä¸ª <code>dev</code> çš„åˆ†æ”¯</li>
</ul>
<pre><code class="hl language-bash">git <span class="hl-built_in">log</span>
<span class="hl-comment"># master devåˆ†æ”¯åˆšå¥½æŒ‡å‘åŒä¸€æ¡çº¿ä¸Š   </span>
<span class="hl-comment"># commit b27787b75a99a614f3b26fe482f0cd47bc3c186b (HEAD -> master, dev)</span>
</code></pre>
<ul>
<li><code>git checkout dev</code>:åˆ‡æ¢åˆ° <code>dev</code> åˆ†æ”¯</li>
</ul>
<pre><code class="hl language-bash">git checkout dev
<span class="hl-built_in">cat</span> .git/HEAD
<span class="hl-comment"># ref: refs/heads/dev</span>
</code></pre>
<ul>
<li>å¦‚æœåœ¨ dev ä¸Šåšå®Œä¸€æ¬¡ <code>commit</code> ä¹‹åï¼Œåˆ†æ”¯ä¹‹é—´ä¼šåˆ†å‰</li>
</ul>
<pre><code class="hl language-bash">git <span class="hl-built_in">log</span>
<span class="hl-comment"># commit 609f9e53903da9cc53127619044bb8a02f36519a (HEAD -> dev)</span>
<span class="hl-comment"># Author: Jack-Zhang-1314 &#x3C;fwqaaq@gmail.com></span>
<span class="hl-comment"># Date:   Sat Jul 2 05:25:37 2022 +0800</span>
<span class="hl-comment"># </span>
<span class="hl-comment">#     dev 1st</span>
<span class="hl-comment"># </span>
<span class="hl-comment"># commit b27787b75a99a614f3b26fe482f0cd47bc3c186b (master)</span>
</code></pre>
<ul>
<li>åˆ é™¤åˆ†æ”¯ï¼Œåªæ˜¯åˆ é™¤åˆ†æ”¯çš„æŒ‡é’ˆï¼Œåˆ†æ”¯ä¸Šçš„å¯¹è±¡ä¸ä¼šè¢«åˆ é™¤</li>
</ul>
<pre><code class="hl language-bash"><span class="hl-comment"># D-->å¼ºåˆ¶åˆ é™¤</span>
git branch -d dev
git branch -D dev

<span class="hl-comment"># æŸ¥çœ‹devåˆ é™¤åçš„commitå†…å®¹</span>
git cat-file -p 609f9e5
<span class="hl-comment"># tree fd59d47bd5ca961d23037b22377a89bc4debdce0</span>
<span class="hl-comment"># parent b27787b75a99a614f3b26fe482f0cd47bc3c186b</span>
<span class="hl-comment"># author Jack-Zhang-1314 &#x3C;fwqaaq@gmail.com> 1656710737 +0800</span>
<span class="hl-comment"># committer Jack-Zhang-1314 &#x3C;fwqaaq@gmail.com> 1656710737 +0800</span>
<span class="hl-comment"># </span>
<span class="hl-comment"># dev 1st</span>
</code></pre>
<h2 id="git-checkout">git checkout<a class="anchor" aria-label="Anchor" aria-hidden="true" data-anchorjs-icon="ğŸ”—" href="#git-checkout"></a></h2>
<blockquote>
<p>ä½¿ç”¨ <code>git checkout</code> å‰å‡ºæŸä¸€æ¬¡ <code>commit</code></p>
</blockquote>
<pre><code class="hl language-bash">git checkout a3d91d1
git branch
<span class="hl-comment"># æŒ‡å‘(HEAD detached at a3d91d1)</span>
git checkout -b tem
<span class="hl-comment">#å°†å½“å‰çš„æäº¤å‰åˆ°æ–°çš„åˆ†æ”¯</span>
git <span class="hl-built_in">log</span> 
<span class="hl-comment"># commit a3d91d125103f57b7b60d7ebd6502aa0987828ab (HEAD -> tem)</span>
</code></pre>
<blockquote>
<p>å°†åˆ é™¤çš„åˆ†æ”¯æ‰¾å›</p>
</blockquote>
<pre><code class="hl language-bash">git reflog
<span class="hl-comment"># a3d91d1 (HEAD -> tem) HEAD@{0}: checkout: moving from a3d91d125103f57b7b60d7ebd6502aa0987828ab to tem</span>
<span class="hl-comment"># a3d91d1 (HEAD -> tem) HEAD@{1}: checkout: moving from master to a3d91d12</span>
<span class="hl-comment"># b27787b (master) HEAD@{2}: checkout: moving from dev to master</span>
<span class="hl-comment"># 609f9e5 HEAD@{3}: commit: dev 1st</span>
<span class="hl-comment"># b27787b (master) HEAD@{4}: checkout: moving from master to dev</span>
<span class="hl-comment"># b27787b (master) HEAD@{5}: commit: 2st commit</span>
<span class="hl-comment"># a3d91d1 (HEAD -> tem) HEAD@{6}: commit (initial): 1st commit</span>
git checkout 609f9e5
git switch -c dev
</code></pre>
<h2 id="è¿œç¨‹åˆ†æ”¯">è¿œç¨‹åˆ†æ”¯<a class="anchor" aria-label="Anchor" aria-hidden="true" data-anchorjs-icon="ğŸ”—" href="#è¿œç¨‹åˆ†æ”¯"></a></h2>
<blockquote>
<p>æ·»åŠ è¿œç¨‹åˆ†æ”¯</p>
</blockquote>
<pre><code class="hl language-bash">git remote add origin ssh...
</code></pre>
<blockquote>
<p>æŸ¥çœ‹æ·»åŠ çš„å†…å®¹<code>cat .git/config</code></p>
</blockquote>
<pre><code class="hl language-bash">[remote <span class="hl-string">"origin"</span>]
        url = https://github.com/Jack-Zhang-1314/hexoPage.git
        fetch = +refs/heads/*:refs/remotes/origin/*
</code></pre>
<pre><code class="hl language-bash">â”œâ”€logs
â”‚  â”‚  HEAD
â”‚  â”‚
â”‚  â”œâ”€refs
â”‚  â”‚    â”œâ”€heads
â”‚  â”‚    â”‚      dev
â”‚  â”‚    â”‚      master
â”‚  â”‚    â”‚
â”‚  â”‚    â””â”€remotes
â”‚  â”‚        â””â”€origin
â”‚  â”‚            â”‚  HEAD
â”‚  â”‚            â””â”€ master
â”œâ”€origin
â”‚  â”‚     HEAD
â”‚  â””---  master
</code></pre>
<ul>
<li>å½“æäº¤è¿œç¨‹ä¹‹åï¼Œæœ¬åœ°åˆ†æ”¯å’Œè¿œç¨‹åˆ†æ”¯æ˜¯åŒæ­¥çš„</li>
</ul>
<pre><code class="hl language-bash"><span class="hl-comment"># commit 4a71286c54dc6629322f13cfded0dfcdb417a1aa (HEAD -> master, origin/master, origin/HEAD)</span>
</code></pre>
<h2 id="å¯¹è±¡å‹ç¼©">å¯¹è±¡å‹ç¼©<a class="anchor" aria-label="Anchor" aria-hidden="true" data-anchorjs-icon="ğŸ”—" href="#å¯¹è±¡å‹ç¼©"></a></h2>
<ol>
<li>
<p>æŸ¥çœ‹ git å¯¹è±¡æ–‡ä»¶çš„å¤§å°</p>
<pre><code class="hl language-bash"><span class="hl-built_in">du</span> -h .git/objects
<span class="hl-comment"># ...</span>
<span class="hl-comment"># 1.1M    .git/objects/fa</span>
<span class="hl-comment"># 944K    .git/objects/fd</span>
<span class="hl-comment"># 0       .git/objects/info</span>
<span class="hl-comment"># 22M     .git/objects/pack</span>
<span class="hl-comment"># 42M     .git/objects</span>
</code></pre>
</li>
<li>
<p>ä½¿ç”¨ <code>git gc</code> æ¥å‹ç¼©æ–‡ä»¶</p>
<pre><code class="hl language-bash">git gc
<span class="hl-built_in">du</span> -h .git/objects
<span class="hl-comment"># 9.0K    .git/objects/info</span>
<span class="hl-comment"># 23M     .git/objects/pack</span>
<span class="hl-comment"># 23M     .git/objects</span>
</code></pre>
</li>
<li>
<p>æŸ¥çœ‹ <code>pack</code> æ–‡ä»¶ä¸‹æ–‡ä»¶çš„å¤§å°ã€‚æ–‡ä»¶è¢«å‹ç¼©åˆ° <code>.pack</code> æ–‡ä»¶ä¸­</p>
<pre><code class="hl language-bash"><span class="hl-built_in">ls</span> -l .git/objects/pack
<span class="hl-comment"># total 23092</span>
<span class="hl-comment"># -r--r--r-- 1 15531 197609   122816  7 æœˆ  2 06:21 pack-04c2ed0bfb1961df8ecdaf3a6a602936173ffc88.idx</span>
<span class="hl-comment"># -r--r--r-- 1 15531 197609 23521212  7 æœˆ  2 06:21 pack-04c2ed0bfb1961df8ecdaf3a6a602936173ffc88.pack</span>
</code></pre>
</li>
</ol>
<blockquote>
<p>è§£å‹ç¼© <code>git unpack-objects</code></p>
</blockquote>
<ul>
<li>é¦–å…ˆ <code>.pack</code> æ–‡ä»¶ä¸èƒ½å† <code>objects</code> æ–‡ä»¶ä¸‹ï¼Œå°†å®ƒç§»åˆ° <code>.git</code> ä¸‹åï¼Œä½¿ç”¨è§£å‹ç¼©çš„å‘½ä»¤</li>
</ul>
<pre><code class="hl language-bash">git unpack-objects &#x3C; .git/pack-04c2ed0bfb1961df8ecdaf3a6a602936173ffc88.pack
</code></pre>
<h2 id="åƒåœ¾å¯¹è±¡æ¸…ç†">åƒåœ¾å¯¹è±¡æ¸…ç†<a class="anchor" aria-label="Anchor" aria-hidden="true" data-anchorjs-icon="ğŸ”—" href="#åƒåœ¾å¯¹è±¡æ¸…ç†"></a></h2>
<blockquote>
<p>åœ¨å¤§éƒ¨åˆ†æ—¶å€™æ¯æ¬¡ä½¿ç”¨ <code>git add</code> ä¼šäº§ç”Ÿä¸å¿…è¦çš„åƒåœ¾å¯¹è±¡ï¼Œè¿™æ—¶å€™å°±éœ€è¦ä½¿ç”¨ <code>git prune</code> å»æ¸…ç†è¿™äº›ä¸å¿…è¦çš„å¯¹è±¡</p>
</blockquote>
<ul>
<li>ä¸è¿‡ä¸€èˆ¬æƒ…å†µä¸‹åœ¨ä½¿ç”¨ <code>git gc</code> å®Œå…¨è¶³å¤Ÿï¼Œä»–ä¼šå»è°ƒç”¨ <code>git prune</code> æ¸…ç†ä¸å¿…è¦çš„å¯¹è±¡</li>
</ul>
<pre><code class="hl language-bash">git prune -n
<span class="hl-comment"># æŸ¥çœ‹å°†ä¼šåˆ é™¤çš„ä¸å¿…è¦çš„åƒåœ¾å¯¹è±¡</span>
git fsck
<span class="hl-comment">#æŸ¥çœ‹ä»“åº“çš„åƒåœ¾å¯¹è±¡</span>
</code></pre>
        </article></main><script src="https://giscus.app/client.js"
        data-repo="fwqaaq/fwqaaq.github.io"
        data-repo-id="R_kgDOHCFK2A"
        data-category="Show and tell"
        data-category-id="DIC_kwDOHCFK2M4CYOLh"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="1"
        data-input-position="bottom"
        data-theme="preferred_color_scheme"
        data-lang="zh-CN"
        crossorigin="anonymous"
        async></script>