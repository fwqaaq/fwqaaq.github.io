<!DOCTYPE html>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <meta name="theme-color" content="rgb(46, 44, 79)">
  <meta name="description" content="Github Action ä¸€äº›é‡è¦å†…å®¹çš„æŸ¥è¯¢">
  <meta name="keywords" content="Git, Github">
  <title>
    Github Action æŠ€å·§æŸ¥è¯¢
  </title>
  <link rel="stylesheet" href="/public/css/index.css">
  <link rel="stylesheet" href="/public/css/markdown.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" />
  <script src="/public/JavaScript/index.js"></script>
</head><header class="blog-header">
  <a href="https://github.com/fwqaaq" target="_blank">
    <img src="https://avatars.githubusercontent.com/u/82551626?v=4" loading="lazy" alt="me" srcset="">
  </a>
  <nav class="header-nav">
    <a class="decoration-line" href="/"><i class="fa-solid fa-house-chimney fa-xs"></i>
      <span class="disappear">Home</span>
    </a>
    <a class="decoration-line" href="/./about/index.html"><i class="fa-solid fa-address-card fa-xs"></i>
      <span class="disappear">About</span></a>
    <a class="decoration-line" href="/./archive/index.html"><i class="fa-solid fa-box-archive fa-xs"></i> <span
        class="disappear">Archive</span></a>
    <a class="decoration-line" href="/./tags/index.html"><i class="fa-solid fa-tag fa-xs"></i> <span
        class="disappear">Tag</span></a>
    <div class="toy"><i class="fa-solid fa-gamepad fa-xs"></i> <span class="disappear">Toy</span>
      <nav class="toy-nav disappear">
        <a class="decoration-line" href="/public/resume/">æˆ‘çš„ç®€å†</a>
        <a class="decoration-line" href="/public/write-css/index.html">å­¦ä¹  UI</a>
      </nav>
    </div>
    <a class="decoration-line" href="/feed.xml"><i class="fa-solid fa-rss fa-xs"></i> <span
        class="disappear">RSS</span></a>
    <a class="decoration-line model" href="#" class="model"><i class="fa-solid fa-sun fa-xs"></i></a>
  </nav>
</header><main class="blog-main">
          <article class="blog-article">
            <h1>Github Action æŠ€å·§æŸ¥è¯¢</h1>
            <hr>
            <h2 id="github-action-ä¸Šä¸‹æ–‡"><a href="https://docs.github.com/zh/actions/learn-github-actions/contexts#about-contexts">Github Action ä¸Šä¸‹æ–‡</a><a class="anchor" aria-label="Anchor" aria-hidden="true" data-anchorjs-icon="ğŸ”—" href="#github-action-ä¸Šä¸‹æ–‡"></a></h2>
<ul>
<li><a href="https://docs.github.com/zh/actions/learn-github-actions/contexts#secrets-context">secrets</a> ä¸Šä¸‹æ–‡ä¸­çš„ <code>secrets.GITHUB_TOKEN</code> ç”¨äºèº«ä»½éªŒè¯</li>
</ul>
<h3 id="è®¾ç½®ç¯å¢ƒå˜é‡"><a href="https://docs.github.com/zh/actions/learn-github-actions/contexts#secrets-context">è®¾ç½®ç¯å¢ƒå˜é‡</a><a class="anchor" aria-label="Anchor" aria-hidden="true" data-anchorjs-icon="ğŸ”—" href="#è®¾ç½®ç¯å¢ƒå˜é‡"></a></h3>
<p>é™¤äº†é€šè¿‡ <a href="https://docs.github.com/zh/actions/learn-github-actions/variables#%E4%B8%BA%E5%8D%95%E4%B8%AA%E5%B7%A5%E4%BD%9C%E6%B5%81%E5%AE%9A%E4%B9%89%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F"><code>env:</code> å­—æ®µ</a>æ¥ç›´æ¥æŒ‡å®šç¯å¢ƒå˜é‡ï¼Œè¿˜å¯ä»¥åœ¨å·¥ä½œæµè¿è¡ŒæœŸé—´ä½¿ç”¨ <a href="https://docs.github.com/zh/actions/using-workflows/workflow-commands-for-github-actions#setting-an-environment-variable"><code>set-env</code></a> å‘½ä»¤æ¥è®¾ç½®ç¯å¢ƒå˜é‡ã€‚</p>
<pre><code class="hl language-bash"><span class="hl-built_in">echo</span> <span class="hl-string">"{environment_variable_name}={value}"</span> >> <span class="hl-string">"<span class="hl-variable">$GITHUB_ENV</span>"</span>
</code></pre>
<h3 id="ä¿ç•™-job-çš„è¾“å‡º"><a href="https://docs.github.com/zh/actions/using-workflows/workflow-commands-for-github-actions#setting-an-output-parameter">ä¿ç•™ job çš„è¾“å‡º</a><a class="anchor" aria-label="Anchor" aria-hidden="true" data-anchorjs-icon="ğŸ”—" href="#ä¿ç•™-job-çš„è¾“å‡º"></a></h3>
<p>è¾“å‡ºä¹Ÿæ˜¯æœ‰ä¸¤ç§æ–¹å¼ï¼ˆä½†æ˜¯è¿™ä¸¤ç§æ–¹å¼éƒ½æ˜¯è¦ job/step çš„ <code>id</code>ï¼‰ï¼š</p>
<ol>
<li>ç›´æ¥ä½¿ç”¨ <a href="https://docs.github.com/zh/actions/using-workflows/workflow-commands-for-github-actions#setting-an-output-parameter"><code>GITHUB_OUTPUT</code></a> æ¥è·å–ï¼Œä½†æ˜¯è¿™ç§æ–¹å¼åªèƒ½åœ¨ç»ˆç«¯ä¸­ä½¿ç”¨</li>
<li>ä½¿ç”¨ <a href="https://docs.github.com/zh/actions/using-workflows/workflow-syntax-for-github-actions#jobsjob_idoutputs"><code>output:</code> å­—æ®µ</a>ï¼Œè¿™ç§æ–¹å¼å¯ä»¥ç”¨äºä»»ä½•ç±»å‹çš„è¾“å‡ºï¼Œè¯¥å­—æ®µåœ¨ä¸åŒçš„ job ä¹‹é—´å¯ä»¥å…±äº«è¾“å‡ºï¼Œä½†æ˜¯éœ€è¦ <code>needs</code> æŒ‡å®šé¡ºåºã€‚</li>
</ol>
<p>å¯ä»¥æŸ¥è¯¢è¿™ä¸ªæ¯”è¾ƒç®€å•çš„<a href="https://github.com/Borber/seam/blob/defa7bf79dc97fefa0521655828e98a5bd2d2a38/.github/workflows/release_gui.yml#L12-L30">ç¤ºä¾‹</a>ï¼Œä»¥ä¸‹ä»…å±•ç¤ºä¸€éƒ¨åˆ†ï¼š</p>
<pre><code class="hl language-yaml">  <span class="hl-attr">create_release:</span>
    <span class="hl-attr">runs-on:</span> <span class="hl-string">ubuntu-latest</span>
    <span class="hl-attr">outputs:</span>
      <span class="hl-attr">changes:</span> <span class="hl-string">${{</span> <span class="hl-string">steps.changelog_reader.outputs.changes</span> <span class="hl-string">}}</span>
      <span class="hl-attr">version:</span> <span class="hl-string">${{</span> <span class="hl-string">steps.changelog_reader.outputs.VERSION</span> <span class="hl-string">}}</span>
    <span class="hl-attr">steps:</span>
      <span class="hl-bullet">-</span> <span class="hl-attr">uses:</span> <span class="hl-string">actions/checkout@v3</span>
      <span class="hl-bullet">-</span> <span class="hl-attr">name:</span> <span class="hl-string">Get</span> <span class="hl-string">version</span> <span class="hl-string">number</span>
        <span class="hl-attr">id:</span> <span class="hl-string">get_version</span>
        <span class="hl-attr">run:</span> <span class="hl-string">|
          VERSION=${GITHUB_REF#refs/tags/}
          echo "VERSION=${VERSION/v_gui\./}" >> $GITHUB_ENV
</span>      <span class="hl-bullet">-</span> <span class="hl-attr">name:</span> <span class="hl-string">Changelog</span> <span class="hl-string">Reader</span>
        <span class="hl-attr">id:</span> <span class="hl-string">changelog_reader</span>
        <span class="hl-attr">uses:</span> <span class="hl-string">mindsers/changelog-reader-action@v2.2.2</span>
        <span class="hl-attr">with:</span>
          <span class="hl-attr">path:</span> <span class="hl-string">'./crates/cli/CHANGELOG.md'</span>
          <span class="hl-attr">version:</span> <span class="hl-string">${{</span> <span class="hl-string">steps.get_version.outputs.version</span> <span class="hl-string">}}</span>
</code></pre>
<p>ä¹‹åæˆ‘ä»¬æŒ‡å®šè¯¥ jobï¼Œç„¶åä½¿ç”¨ <code>${{ needs.create_release.outputs.changes }}</code> æ–¹å¼æ¥è®¿é—®ã€‚</p>
<h2 id="æŒ‡å®šä»“åº“æ‰§è¡Œ">æŒ‡å®šä»“åº“æ‰§è¡Œ<a class="anchor" aria-label="Anchor" aria-hidden="true" data-anchorjs-icon="ğŸ”—" href="#æŒ‡å®šä»“åº“æ‰§è¡Œ"></a></h2>
<p>åœ¨å…¶å®ƒæˆå‘˜ fork ä»“åº“çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¸å¸Œæœ›å…¶å®ƒæˆå‘˜ä¹Ÿè¿è¡Œ GitHub workflowï¼Œå¯ä»¥ä½¿ç”¨ if è¯­å¥è¿›è¡Œåˆ¤åˆ«ã€‚åƒè¿™æ ·ï¼š</p>
<pre><code class="hl language-yaml"><span class="hl-attr">if:</span> <span class="hl-string">github.repository</span> <span class="hl-string">==</span> <span class="hl-string">'jaywcjlove/reference'</span>
</code></pre>
<p>å‚è€ƒï¼š<a href="https://github.com/fwqaaq/translator/blob/23dcf1f6679531457df49d38d6b9e28dd8430d8d/.github/workflows/main.yaml#L12">https://github.com/fwqaaq/translator/blob/23dcf1f6679531457df49d38d6b9e28dd8430d8d/.github/workflows/main.yaml#L12</a></p>
<h2 id="çŸ©é˜µç­–ç•¥"><a href="https://docs.github.com/zh/actions/using-jobs/using-a-matrix-for-your-jobs#using-a-matrix-strategy">çŸ©é˜µç­–ç•¥</a><a class="anchor" aria-label="Anchor" aria-hidden="true" data-anchorjs-icon="ğŸ”—" href="#çŸ©é˜µç­–ç•¥"></a></h2>
<p>åœ¨ matrix ä½ å¯ä»¥æŒ‡å®šä¸åŒå¹³å°ï¼Œä¸åŒç‰ˆæœ¬ä¹‹é—´çš„ç»„åˆï¼Œè¿›è¡Œå¤šä¸ª job çš„æ‰§è¡Œã€‚</p>
        </article></main><script src="https://giscus.app/client.js"
        data-repo="fwqaaq/fwqaaq.github.io"
        data-repo-id="R_kgDOHCFK2A"
        data-category="Show and tell"
        data-category-id="DIC_kwDOHCFK2M4CYOLh"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="1"
        data-input-position="bottom"
        data-theme="preferred_color_scheme"
        data-lang="zh-CN"
        crossorigin="anonymous"
        async></script>